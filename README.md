# Process Flow Visualization Tool for Audit Logs

This tool analyzes and visualizes process relationships, behaviors, and timelines from Linux audit logs generated by auditbeat. It combines traditional rule-based analysis with machine learning to provide comprehensive process behavior analysis and visualization.

## Features

- Parses auditbeat NDJSON log files
- Builds process hierarchy trees and activity timelines
- Identifies suspicious process behaviors and security concerns
- Generates visualizations using Mermaid.js
- Provides multiple visualization views:
  - Process Tree View: Shows hierarchical relationships
  - Timeline View: Shows process activities over time
  - Analysis Comparison: Compares traditional and ML analysis results
- Color-coded process classification:
  - ðŸŸ¢ Green: Root processes (PID 1)
  - ðŸ”µ Blue: Normal processes
  - ðŸŸ  Orange: Privileged processes (running as root)
  - ðŸ”´ Red: Suspicious processes

## Security Analysis

The tool performs security analysis:

### Process Name Analysis
- Detection of hex-encoded and obfuscated names
- Recognition of known suspicious process names
- Identification of attack indicators
- Analysis of unusual character distributions
- Detection of Unicode/non-ASCII characters

### Behavior Analysis
- System call pattern analysis
- Privilege escalation attempts
- File system operations
- Network activity patterns
- Process manipulation
- Resource usage patterns

### Machine Learning Analysis
- Unsupervised anomaly detection
- Process behavior pattern learning
- Automatic feature extraction
- Syscall frequency analysis
- Temporal pattern recognition

### Security Alerts
- Suspicious execution patterns
- Failed operations
- Privilege abuse
- Network abuse patterns
- File system tampering
- Command injection attempts

## Installation

1. Clone the repository:
```bash
git clone https://github.com/toopieare/CS5231_Proj.git
cd CS5231_Proj
```

2. Create a virtual environment (recommended):
```bash
python -m venv .venv
source .venv/bin/activate  # On Windows: .venv\Scripts\activate
```

3. Install dependencies:
```bash
pip install -r requirements.txt
```

## Usage

1. Place your auditbeat log file in the `input` directory and update config.py to indicate the correct filename
2. Run the tool:
```bash
python main.py
```

3. View the visualizations:
- Open `output/process_flow.html` for the process hierarchy view
- Open `output/process_gantt.html` for the timeline view


## Project Structure

```
CS5231_Proj/
â”œâ”€â”€ config.py           # Configuration settings
â”œâ”€â”€ main.py            # Main application entry point
â”œâ”€â”€ requirements.txt   # Python dependencies
â”œâ”€â”€ src/
â”‚   â”œâ”€â”€ analysis/      # Analysis modules
â”‚   â”‚   â”œâ”€â”€ behavior_analyzer.py    # Traditional behavior analysis
â”‚   â”‚   â”œâ”€â”€ ml_behavior_analyzer.py # Machine learning analysis
â”‚   â”‚   â”œâ”€â”€ process_tree.py        # Process hierarchy building
â”‚   â”‚   â”œâ”€â”€ security_analyzer.py    # Security checks
â”‚   â”‚   â””â”€â”€ analysis_reporter.py    # Analysis comparison reporting
â”‚   â”œâ”€â”€ data/          # Data processing
â”‚   â”‚   â”œâ”€â”€ data_processor.py      # Log data processing
â”‚   â”‚   â””â”€â”€ log_loader.py          # Log file handling
â”‚   â”œâ”€â”€ utils/         # Utility functions
â”‚   â””â”€â”€ visualization/ # Visualization generators
â”‚       â”œâ”€â”€ html_generator.py      # HTML output generation
â”‚       â””â”€â”€ mermaid_generator.py   # Diagram generation
â”œâ”€â”€ input/             # Input log files
â””â”€â”€ output/           # Generated visualizations
```

## Understanding the Visualizations

### Process Tree View
- Shows hierarchical relationships between processes
- Indicates process states and security concerns
- Provides detailed process information and alerts
- Color-coded for quick status identification

### Timeline View
- Shows process lifetimes and activities
- Groups processes by type and behavior
- Indicates activity levels and suspicious patterns
- Provides temporal context for process behaviors

### Edge Types
- Normal edges (-->) indicate standard relationships
- Bold edges (==>) indicate suspicious process relationships
- Red nodes indicate security concerns
- Orange nodes indicate privileged operations

### ML-Based Analysis
- Uses autoencoder for anomaly detection
- Learns normal process behavior patterns
- Identifies unusual syscall patterns
- Provides anomaly scores
- Adapts to system-specific patterns

### Comparative Visualization
- Interactive scatter plot of analysis scores
- Score distribution histograms
- Detailed process-level metrics
- Category-based score breakdowns
- Debug information for validation